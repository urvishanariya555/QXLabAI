<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no">
  <title>Qx Lab AI</title>
  <link rel="stylesheet" href="./style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
      integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
</head>

  <body>
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid" style="padding: 0 24px;">
        <div class="header-logo">
          <a href="overView.html">QX LAB AI</a>
        </div>
        <button class="navbar-toggler ps-0 pe-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-md-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active custom-res-text" aria-current="page" href="overView.html">Overview</a>
            </li>
            <li class="nav-item">
              <a class="nav-link d-res-none res-active" href="documentation.html">Documentation</a>
              <div class="accordion res-header-bar-list" id="accordionExample">
                <div class="accordion-item">
                  <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                      Documentation
                    </button>
                  </h2>
                  <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                      <a href="documentation.html">
                        Introduction
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="quick-start.html">
                        Quickstart
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="libraries.html">
                        Libraries
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="models.html">
                        Models
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="deprecations.html">
                        Deprecations
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="tutorials.html">
                        Tutorials
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="policies.html">
                        Policies
                      </a>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                      Guides
                    </button>
                  </h2>
                  <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                      <a href="GPT-Models.html">
                        GPT
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="gpt-best-practices.html">
                        GPT best practices
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="image-generation.html">
                        Image generation
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="fine-tuning.html">
                        Fine-tuning
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="embeddings.html">
                        Embeddings
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="speech-to-text.html">
                        Speech to text
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="moderation.html">
                        moderation
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="rate-limits.html">
                        rate-limits
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="error-codes.html">
                        Error codes
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="safety-best-practices.html">
                        Safety best practices
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="production-best-practices.html">
                        Production best practices
                      </a>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h2 class="accordion-header" id="headingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                      Plugins
                    </button>
                  </h2>
                  <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                      <a href="plugins-introduction.html">
                        Introduction
                      </a>
                    </div>
                    <div class="accordion-body">
                      <a href="plugins-getting-started.html">
                        Getting started
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="plugins-authentication.html">
                        Authentication
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="plugins-examples.html">
                        Examples
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="plugins-production.html">
                        Production
                      </a>
                      </div>
                    <div class="accordion-body">
                      <a href="plugins-review.html">
                        Plugin review
                      </a>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <div class="accordion-header" >
                    <a href="api-reference.html" class="accordion-button collapsed pt-1 pb-1">
                      API reference
                    </a>
                  </div>
                </div>
                <div class="accordion-item">
                  <div class="accordion-header" >
                    <a href="examples.html" class="accordion-button collapsed pt-1 pb-1">
                      Examples
                    </a>
                  </div>
                </div>
                <div class="accordion-item">
                  <div class="accordion-header" >
                    <a class="accordion-button collapsed pt-1 pb-1">
                      Log in
                    </a>
                  </div>
                </div>
                <div class="accordion-item">
                  <div class="accordion-header" >
                    <a class="accordion-button collapsed pt-1 pb-1">
                      Sign up
                    </a>
                  </div>
                </div>
              </div>
            </li>
            <li class="nav-item">
              <a class="nav-link d-res-none" href="api-reference.html">API reference</a>
            </li>
            <li class="nav-item">
              <a class="nav-link d-res-none" href="examples.html">Examples</a>
            </li>
          </ul>
          <div class="res-flex">
            <button type="button" class="btn d-res-none">Log in</button>
            <button type="button" class="btn logInbtn d-res-none">Sign up</button>
          </div>
        </div>
      </div>
    </nav>
    <div class="d-flex layout">
      <div class="left-content">
        <div id="list-example" class="list-group border-radius-0">
          
          <div id="scrollspy">
            <div class="sidebarPadding sidebarMainText">
              GET STARTED
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="documentation.html">
                <img src="./images/intro.svg" class="sidebarIcon"/>Introduction
              </a>
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="quick-start.html">
                <img src="./images/quickStarted.svg" class="sidebarIcon"/>Quickstart
              </a>
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="libraries.html">
                <img src="./images/Libraries.svg" class="sidebarIcon"/>Libraries
              </a>
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="models.html">
                <img src="./images/Models.svg" class="sidebarIcon"/>Models
              </a>
            </div>
            <a class="sidebarListText sidebarSubListText" href="deprecations.html">
              <img src="./images/Deprecations.svg" class="sidebarIcon"/>Deprecations
            </a>
            <a class="sidebarListText sidebarSubListText" href="tutorials.html">
              <img src="./images/Tutorials.svg" class="sidebarIcon"/>Tutorials
            </a>
            <a class="sidebarListText sidebarSubListText" href="policies.html">
              <img src="./images/Policies.svg" class="sidebarIcon"/>Policies
            </a>
          </div>
          <div class="sectionTopSection">
            <div class="sidebarPadding sidebarMainText">
              Guides
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="GPT-Models.html">
                <img src="./images/Gpt.svg" class="sidebarIcon"/>GPT
              </a>
            </div>
            <a class="sidebarListText sidebarSubListText" href="gpt-best-practices.html">
              <img src="./images/gptBestPractice.svg" class="sidebarIcon"/>GPT best practices
            </a>
            <div>
              <a class="sidebarListText sidebarSubListText" href="image-generation.html">
                <img src="./images/imagegeneration.svg" class="sidebarIcon"/>Image generation
              </a>
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="fine-tuning.html">
                <img src="./images/fineTuning.svg" class="sidebarIcon"/>Fine-tuning
              </a>
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="embeddings.html">
                <img src="./images/embedding.svg" class="sidebarIcon"/>Embeddings
              </a>              
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="speech-to-text.html">
                <img src="./images/speechtotext.svg" class="sidebarIcon"/>Speech to text
              </a>          
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="moderation.html">
                <img src="./images/moderation.svg" class="sidebarIcon"/>Moderation
              </a>
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="rate-limits.html">
                <img src="./images/ratelimit.svg" class="sidebarIcon"/>Rate Limits
              </a>
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="error-codes.html">
                <img src="./images/errorcode.svg" class="sidebarIcon"/>Error codes
              </a>
            </div>
            <div>
              <a class="sidebarListText sidebarSubListText" href="safety-best-practices.html">
                <img src="./images/Safety-best-practices.svg" class="sidebarIcon"/>Safety best practices
              </a>
            </div>
            <a class="sidebarListText sidebarSubListText" href="production-best-practices.html">
              <img src="./images/Productionbest-practices.svg" class="sidebarIcon"/>Production best practices
            </a>
          </div>
          <div class="sectionTopSection">
            <div class="sidebarPadding sidebarMainText">
              Chat plugins
            </div>
            <a class="sidebarListText sidebarSubListText" href="plugins-introduction.html">
              <img src="./images/intro.svg" class="sidebarIcon"/>Introduction
            </a>
            <a class="sidebarListText sidebarSubListText" href="plugins-getting-started.html">
              <img src="./images/gettingStarted.svg" class="sidebarIcon"/>Getting started
            </a>
            <a class="sidebarListText sidebarSubListText" href="plugins-authentication.html">
              <img src="./images/Plugin-authentication.svg" class="sidebarIcon"/>Authentication
            </a>
            <a class="sidebarListText list-group-item active" href="plugins-examples.html">
              <img src="./images/example.svg" class="sidebarIcon"/>Examples
            </a>
            <a class="sidebarListText sidebarSubListText" href="plugins-production.html">
              <img src="./images/production.svg" class="sidebarIcon"/>Production
            </a>
            <a class="sidebarListText sidebarSubListText" href="plugins-review.html">
              <img src="./images/plugin_review.svg" class="sidebarIcon"/>Plugin review
            </a>
            <div class="sidebarListText">
              <img src="./images/Plugin_policies.svg" class="sidebarIcon"/>Plugin policies
            </div>
          </div>
        </div>
      </div>
      <div class="right-content custom-right-content">
        <div class="custom-right-content-width">
          <div data-bs-spy="scroll" data-bs-target="#list-example" data-bs-smooth-scroll="true"
            class="scrollspy-example pt-4" tabindex="0">
            <div class="markdown-page markdown-content"><div class="anchor-heading-root"><a class="anchor-heading-link" href="/docs/plugins/examples/example-plugins"><h1 class="anchor-heading" name="example-plugins">Example plugins</h1></a></div><p>To get started building, we are making available a set of simple plugins that cover different authentication schemas and use cases. From our simple no authentication todo list plugin to the more <a href="https://github.com/QX LabAI/Ask Qx-retrieval-plugin/" target="_blank" rel="noopener noreferrer">powerful retrieval plugin</a>, these examples provide a glimpse into what we hope to make possible with plugins.</p><p>During development, you can run the plugin <a href="/docs/plugins/getting-started/running-a-plugin">locally on your computer</a> or through a cloud development environment like <a href="https://github.com/features/codespaces" target="_blank" rel="noopener noreferrer">GitHub Codespaces</a>, <a href="https://replit.com/" target="_blank" rel="noopener noreferrer">Replit</a>, or <a href="https://codesandbox.io/" target="_blank" rel="noopener noreferrer">CodeSandbox</a>.</p><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-0"><div class="expn-icon"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"></path></svg></div><div class="expn-label">Plugin quickstart</div></div><div class="expn-content hidden" id="expander-0"><p>We created the plugin quickstart as a starting place for developers to get a plugin up and running in less than 5 minutes. If you have not run a plugin yet and want to get acquainted with the minimal steps required to run one, consider beginning with the <a href="https://github.com/QX LabAI/plugins-quickstart" target="_blank" rel="noopener noreferrer">plugin quickstart repo</a>.</p><div class="expn-collapse"><button tabindex="0" class="btn btn-sm btn-filled btn-neutral" type="button"><span class="btn-label-wrap"><span class="btn-label-inner">Collapse&zwj;</span></span></button></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-1"><div class="expn-icon"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"></path></svg></div><div class="expn-label">Learn how to build a simple todo list plugin with no auth</div></div><div class="expn-content hidden" id="expander-1"><p>To start, check out the <a href="/docs/plugins/authentication/no-authentication">no authentication</a> page, then define an <code>ai-plugin.json</code> file with the following fields:</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-json" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span></code><span class=""><span class="">{
</span></span><span class=""><span class="">    </span><span class="hljs-string">"schema_version"</span><span class="">: </span><span class="hljs-string">"v1"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"name_for_human"</span><span class="">: </span><span class="hljs-string">"TODO List (No Auth)"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"name_for_model"</span><span class="">: </span><span class="hljs-string">"todo"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"description_for_human"</span><span class="">: </span><span class="hljs-string">"Manage your TODO list. You can add, remove and view your TODOs."</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"description_for_model"</span><span class="">: </span><span class="hljs-string">"Plugin for managing a TODO list, you can add, remove and view your TODOs."</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"auth"</span><span class="">: {
</span></span><span class=""><span class="">        </span><span class="hljs-string">"type"</span><span class="">: </span><span class="hljs-string">"none"</span><span class="">
</span></span><span class="">    },
</span><span class=""><span class="">    </span><span class="hljs-string">"api"</span><span class="">: {
</span></span><span class=""><span class="">        </span><span class="hljs-string">"type"</span><span class="">: </span><span class="hljs-string">"openapi"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"url"</span><span class="">: </span><span class="hljs-string">"PLUGIN_HOSTNAME/openapi.yaml"</span><span class="">
</span></span><span class="">    },
</span><span class=""><span class="">    </span><span class="hljs-string">"logo_url"</span><span class="">: </span><span class="hljs-string">"PLUGIN_HOSTNAME/logo.png"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"contact_email"</span><span class="">: </span><span class="hljs-string">"support@example.com"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"legal_info_url"</span><span class="">: </span><span class="hljs-string">"https://example.com/legal"</span><span class="">
</span></span><span class="">}</span></code></pre></div></div><p>Note the <code>PLUGIN_HOSTNAME</code> should be the actual hostname of your plugin server.</p><p>Next, we can define the API endpoints to create, delete, and fetch todo list items for a specific user.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-python" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span><span class="react-syntax-highlighter-line-number">57
</span><span class="react-syntax-highlighter-line-number">58
</span><span class="react-syntax-highlighter-line-number">59
</span><span class="react-syntax-highlighter-line-number">60
</span><span class="react-syntax-highlighter-line-number">61
</span><span class="react-syntax-highlighter-line-number">62
</span><span class="react-syntax-highlighter-line-number">63
</span><span class="react-syntax-highlighter-line-number">64
</span><span class="react-syntax-highlighter-line-number">65
</span><span class="react-syntax-highlighter-line-number">66
</span><span class="react-syntax-highlighter-line-number">67
</span></code><span class=""><span class="hljs-keyword">import</span><span class=""> json
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> quart
</span></span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> quart_cors
</span></span><span class=""><span class=""></span><span class="hljs-keyword">from</span><span class=""> quart </span><span class="hljs-keyword">import</span><span class=""> request
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-comment"># Note: Setting CORS to allow chat.openapi.com is only required when running a localhost plugin</span><span class="">
</span></span><span class=""><span class="">app = quart_cors.cors(quart.Quart(__name__), allow_origin=</span><span class="hljs-string">"https://chat.qxlabai.com"</span><span class="">)
</span></span><span class="">
</span><span class="">_TODOS = {}
</span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.post(</span><span class="hljs-meta hljs-params hljs-string">"/todos/&lt;string:username&gt;"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">add_todo</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">username</span><span class="hljs-function">):</span><span class="">
</span></span><span class=""><span class="">    request = </span><span class="hljs-keyword">await</span><span class=""> quart.request.get_json(force=</span><span class="hljs-literal">True</span><span class="">)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> username </span><span class="hljs-keyword">not</span><span class=""> </span><span class="hljs-keyword">in</span><span class=""> _TODOS:
</span></span><span class="">        _TODOS[username] = []
</span><span class=""><span class="">    _TODOS[username].append(request[</span><span class="hljs-string">"todo"</span><span class="">])
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=</span><span class="hljs-string">'OK'</span><span class="">, status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/todos/&lt;string:username&gt;"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">get_todos</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">username</span><span class="hljs-function">):</span><span class="">
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=json.dumps(_TODOS.get(username, [])), status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.delete(</span><span class="hljs-meta hljs-params hljs-string">"/todos/&lt;string:username&gt;"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">delete_todo</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">username</span><span class="hljs-function">):</span><span class="">
</span></span><span class=""><span class="">    request = </span><span class="hljs-keyword">await</span><span class=""> quart.request.get_json(force=</span><span class="hljs-literal">True</span><span class="">)
</span></span><span class=""><span class="">    todo_idx = request[</span><span class="hljs-string">"todo_idx"</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> </span><span class="hljs-number">0</span><span class=""> &lt;= todo_idx &lt; </span><span class="hljs-built_in">len</span><span class="">(_TODOS[username]):
</span></span><span class="">        _TODOS[username].pop(todo_idx)
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=</span><span class="hljs-string">'OK'</span><span class="">, status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/logo.png"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">plugin_logo</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    filename = </span><span class="hljs-string">'logo.png'</span><span class="">
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> </span><span class="hljs-keyword">await</span><span class=""> quart.send_file(filename, mimetype=</span><span class="hljs-string">'image/png'</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/.well-known/ai-plugin.json"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">plugin_manifest</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    host = request.headers[</span><span class="hljs-string">'Host'</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">with</span><span class=""> </span><span class="hljs-built_in">open</span><span class="">(</span><span class="hljs-string">"ai-plugin.json"</span><span class="">) </span><span class="hljs-keyword">as</span><span class=""> f:
</span></span><span class="">        text = f.read()
</span><span class=""><span class="">        </span><span class="hljs-comment"># This is a trick we do to populate the PLUGIN_HOSTNAME constant in the manifest</span><span class="">
</span></span><span class=""><span class="">        text = text.replace(</span><span class="hljs-string">"PLUGIN_HOSTNAME"</span><span class="">, </span><span class="hljs-string">f"https://</span><span class="hljs-string hljs-subst">{host}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">return</span><span class=""> quart.Response(text, mimetype=</span><span class="hljs-string">"text/json"</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/openapi.yaml"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">openapi_spec</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    host = request.headers[</span><span class="hljs-string">'Host'</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">with</span><span class=""> </span><span class="hljs-built_in">open</span><span class="">(</span><span class="hljs-string">"openapi.yaml"</span><span class="">) </span><span class="hljs-keyword">as</span><span class=""> f:
</span></span><span class="">        text = f.read()
</span><span class=""><span class="">        </span><span class="hljs-comment"># This is a trick we do to populate the PLUGIN_HOSTNAME constant in the OpenAPI spec</span><span class="">
</span></span><span class=""><span class="">        text = text.replace(</span><span class="hljs-string">"PLUGIN_HOSTNAME"</span><span class="">, </span><span class="hljs-string">f"https://</span><span class="hljs-string hljs-subst">{host}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">return</span><span class=""> quart.Response(text, mimetype=</span><span class="hljs-string">"text/yaml"</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">main</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    app.run(debug=</span><span class="hljs-literal">True</span><span class="">, host=</span><span class="hljs-string">"0.0.0.0"</span><span class="">, port=</span><span class="hljs-number">5002</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-keyword">if</span><span class=""> __name__ == </span><span class="hljs-string">"__main__"</span><span class="">:
</span></span><span class="">    main()</span></code></pre></div></div><p>Last, we need to set up and define a OpenAPI specification to match the endpoints defined on our local or remote server. You do not need to expose the full functionality of your API via the specification and can instead choose to let Ask Qx have access to only certain functionality.</p><p>There are also many tools that will automatically turn your server definition code into an OpenAPI specification so you don’t need to do it manually. In the case of the Python code above, the OpenAPI specification will look like:</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-yaml" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span><span class="react-syntax-highlighter-line-number">57
</span><span class="react-syntax-highlighter-line-number">58
</span><span class="react-syntax-highlighter-line-number">59
</span><span class="react-syntax-highlighter-line-number">60
</span><span class="react-syntax-highlighter-line-number">61
</span><span class="react-syntax-highlighter-line-number">62
</span><span class="react-syntax-highlighter-line-number">63
</span><span class="react-syntax-highlighter-line-number">64
</span><span class="react-syntax-highlighter-line-number">65
</span><span class="react-syntax-highlighter-line-number">66
</span><span class="react-syntax-highlighter-line-number">67
</span><span class="react-syntax-highlighter-line-number">68
</span><span class="react-syntax-highlighter-line-number">69
</span><span class="react-syntax-highlighter-line-number">70
</span><span class="react-syntax-highlighter-line-number">71
</span><span class="react-syntax-highlighter-line-number">72
</span><span class="react-syntax-highlighter-line-number">73
</span><span class="react-syntax-highlighter-line-number">74
</span><span class="react-syntax-highlighter-line-number">75
</span><span class="react-syntax-highlighter-line-number">76
</span><span class="react-syntax-highlighter-line-number">77
</span><span class="react-syntax-highlighter-line-number">78
</span><span class="react-syntax-highlighter-line-number">79
</span><span class="react-syntax-highlighter-line-number">80
</span><span class="react-syntax-highlighter-line-number">81
</span><span class="react-syntax-highlighter-line-number">82
</span><span class="react-syntax-highlighter-line-number">83
</span><span class="react-syntax-highlighter-line-number">84
</span><span class="react-syntax-highlighter-line-number">85
</span><span class="react-syntax-highlighter-line-number">86
</span><span class="react-syntax-highlighter-line-number">87
</span><span class="react-syntax-highlighter-line-number">88
</span><span class="react-syntax-highlighter-line-number">89
</span><span class="react-syntax-highlighter-line-number">90
</span><span class="react-syntax-highlighter-line-number">91
</span><span class="react-syntax-highlighter-line-number">92
</span><span class="react-syntax-highlighter-line-number">93
</span></code><span class=""><span class="">openapi: </span><span class="hljs-number">3.0</span><span class="hljs-number">.1</span><span class="">
</span></span><span class="">info:
</span><span class="">    title: TODO Plugin
</span><span class=""><span class="">    description: A plugin that allows the </span><span class="hljs-keyword">user</span><span class=""> </span><span class="hljs-keyword">to</span><span class=""> </span><span class="hljs-keyword">create</span><span class=""> </span><span class="hljs-keyword">and</span><span class=""> manage a TODO list </span><span class="hljs-keyword">using</span><span class=""> Ask Qx. If you do </span><span class="hljs-keyword">not</span><span class=""> know the </span><span class="hljs-keyword">user</span><span class="hljs-string">'s username, ask them first before making queries to the plugin. Otherwise, use the username "global".
</span></span><span class="hljs-string">    version: "v1"
</span><span class="hljs-string">servers:
</span><span class="hljs-string">    - url: PLUGIN_HOSTNAME
</span><span class="hljs-string">paths:
</span><span class="hljs-string">    /todos/{username}:
</span><span class="hljs-string">        get:
</span><span class="hljs-string">            operationId: getTodos
</span><span class="hljs-string">            summary: Get the list of todos
</span><span class="hljs-string">            parameters:
</span><span class="hljs-string">                - in: path
</span><span class="hljs-string">                  name: username
</span><span class="hljs-string">                  schema:
</span><span class="hljs-string">                      type: string
</span><span class="hljs-string">                  required: true
</span><span class="hljs-string">                  description: The name of the user.
</span><span class="hljs-string">            responses:
</span><span class="hljs-string">                "200":
</span><span class="hljs-string">                    description: OK
</span><span class="hljs-string">                    content:
</span><span class="hljs-string">                        application/json:
</span><span class="hljs-string">                            schema:
</span><span class="hljs-string">                                $ref: "#/components/schemas/getTodosResponse"
</span><span class="hljs-string">        post:
</span><span class="hljs-string">            operationId: addTodo
</span><span class="hljs-string">            summary: Add a todo to the list
</span><span class="hljs-string">            parameters:
</span><span class="hljs-string">                - in: path
</span><span class="hljs-string">                  name: username
</span><span class="hljs-string">                  schema:
</span><span class="hljs-string">                      type: string
</span><span class="hljs-string">                  required: true
</span><span class="hljs-string">                  description: The name of the user.
</span><span class="hljs-string">            requestBody:
</span><span class="hljs-string">                required: true
</span><span class="hljs-string">                content:
</span><span class="hljs-string">                    application/json:
</span><span class="hljs-string">                        schema:
</span><span class="hljs-string">                            $ref: "#/components/schemas/addTodoRequest"
</span><span class="hljs-string">            responses:
</span><span class="hljs-string">                "200":
</span><span class="hljs-string">                    description: OK
</span><span class="hljs-string">        delete:
</span><span class="hljs-string">            operationId: deleteTodo
</span><span class="hljs-string">            summary: Delete a todo from the list
</span><span class="hljs-string">            parameters:
</span><span class="hljs-string">                - in: path
</span><span class="hljs-string">                  name: username
</span><span class="hljs-string">                  schema:
</span><span class="hljs-string">                      type: string
</span><span class="hljs-string">                  required: true
</span><span class="hljs-string">                  description: The name of the user.
</span><span class="hljs-string">            requestBody:
</span><span class="hljs-string">                required: true
</span><span class="hljs-string">                content:
</span><span class="hljs-string">                    application/json:
</span><span class="hljs-string">                        schema:
</span><span class="hljs-string">                            $ref: "#/components/schemas/deleteTodoRequest"
</span><span class="hljs-string">            responses:
</span><span class="hljs-string">                "200":
</span><span class="hljs-string">                    description: OK
</span><span class="hljs-string">
</span><span class="hljs-string">components:
</span><span class="hljs-string">    schemas:
</span><span class="hljs-string">        getTodosResponse:
</span><span class="hljs-string">            type: object
</span><span class="hljs-string">            properties:
</span><span class="hljs-string">                todos:
</span><span class="hljs-string">                    type: array
</span><span class="hljs-string">                    items:
</span><span class="hljs-string">                        type: string
</span><span class="hljs-string">                    description: The list of todos.
</span><span class="hljs-string">        addTodoRequest:
</span><span class="hljs-string">            type: object
</span><span class="hljs-string">            required:
</span><span class="hljs-string">                - todo
</span><span class="hljs-string">            properties:
</span><span class="hljs-string">                todo:
</span><span class="hljs-string">                    type: string
</span><span class="hljs-string">                    description: The todo to add to the list.
</span><span class="hljs-string">                    required: true
</span><span class="hljs-string">        deleteTodoRequest:
</span><span class="hljs-string">            type: object
</span><span class="hljs-string">            required:
</span><span class="hljs-string">                - todo_idx
</span><span class="hljs-string">            properties:
</span><span class="hljs-string">                todo_idx:
</span><span class="hljs-string">                    type: integer
</span><span class="hljs-string">                    description: The index of the todo to delete.
</span><span class="hljs-string">                    required: true</span></code></pre></div></div><div class="expn-collapse"><button tabindex="0" class="btn btn-sm btn-filled btn-neutral" type="button"><span class="btn-label-wrap"><span class="btn-label-inner">Collapse&zwj;</span></span></button></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-2"><div class="expn-icon"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"></path></svg></div><div class="expn-label">Learn how to build a simple todo list plugin with service level auth</div></div><div class="expn-content hidden" id="expander-2"><p>To start, check out the <a href="/docs/plugins/authentication/service-level">service level authentication</a> page and then define an <code>ai-plugin.json</code> file with the following fields:</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-json" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span></code><span class=""><span class="">{
</span></span><span class=""><span class="">    </span><span class="hljs-string">"schema_version"</span><span class="">: </span><span class="hljs-string">"v1"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"name_for_human"</span><span class="">: </span><span class="hljs-string">"TODO List (service auth)"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"name_for_model"</span><span class="">: </span><span class="hljs-string">"todo"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"description_for_human"</span><span class="">: </span><span class="hljs-string">"Manage your TODO list. You can add, remove and view your TODOs."</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"description_for_model"</span><span class="">: </span><span class="hljs-string">"Plugin for managing a TODO list, you can add, remove and view your TODOs."</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"auth"</span><span class="">: {
</span></span><span class=""><span class="">        </span><span class="hljs-string">"type"</span><span class="">: </span><span class="hljs-string">"service_http"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"authorization_type"</span><span class="">: </span><span class="hljs-string">"bearer"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"verification_tokens"</span><span class="">: {
</span></span><span class=""><span class="">            </span><span class="hljs-string">"QX LabAI"</span><span class="">: </span><span class="hljs-string">"Replace_this_string_with_the_verification_token_generated_in_the_Ask Qx_UI"</span><span class="">
</span></span><span class="">        }
</span><span class="">    },
</span><span class=""><span class="">    </span><span class="hljs-string">"api"</span><span class="">: {
</span></span><span class=""><span class="">        </span><span class="hljs-string">"type"</span><span class="">: </span><span class="hljs-string">"openapi"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"url"</span><span class="">: </span><span class="hljs-string">"https://example.com/openapi.yaml"</span><span class="">
</span></span><span class="">    },
</span><span class=""><span class="">    </span><span class="hljs-string">"logo_url"</span><span class="">: </span><span class="hljs-string">"https://example.com/logo.png"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"contact_email"</span><span class="">: </span><span class="hljs-string">"support@example.com"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"legal_info_url"</span><span class="">: </span><span class="hljs-string">"https://example.com/legal"</span><span class="">
</span></span><span class="">}</span></code></pre></div></div><p>Notice that the verification token is required for service level authentication plugins. The token is generated during the plugin installation process in the Ask Qx web UI after you set the service access token.</p><p>You will also need to update "Example.com" to the name of your remote server.</p><p>Next, we can define the API endpoints to create, delete, and fetch todo list items for a specific user. The endpoints also check that the user is authenticated.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-python" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span><span class="react-syntax-highlighter-line-number">57
</span><span class="react-syntax-highlighter-line-number">58
</span><span class="react-syntax-highlighter-line-number">59
</span><span class="react-syntax-highlighter-line-number">60
</span><span class="react-syntax-highlighter-line-number">61
</span><span class="react-syntax-highlighter-line-number">62
</span><span class="react-syntax-highlighter-line-number">63
</span></code><span class=""><span class="hljs-keyword">import</span><span class=""> json
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> quart
</span></span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> quart_cors
</span></span><span class=""><span class=""></span><span class="hljs-keyword">from</span><span class=""> quart </span><span class="hljs-keyword">import</span><span class=""> request
</span></span><span class="">
</span><span class="">app = quart_cors.cors(quart.Quart(__name__))
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-comment"># This key can be anything, though you will likely want a randomly generated sequence.</span><span class="">
</span></span><span class=""><span class="">_SERVICE_AUTH_KEY = </span><span class="hljs-string">"REPLACE_ME"</span><span class="">
</span></span><span class="">_TODOS = {}
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">assert_auth_header</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">req</span><span class="hljs-function">):</span><span class="">
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">assert</span><span class=""> req.headers.get(
</span></span><span class=""><span class="">        </span><span class="hljs-string">"Authorization"</span><span class="">, </span><span class="hljs-literal">None</span><span class="">) == </span><span class="hljs-string">f"Bearer </span><span class="hljs-string hljs-subst">{_SERVICE_AUTH_KEY}</span><span class="hljs-string">"</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.post(</span><span class="hljs-meta hljs-params hljs-string">"/todos/&lt;string:username&gt;"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">add_todo</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">username</span><span class="hljs-function">):</span><span class="">
</span></span><span class="">    assert_auth_header(quart.request)
</span><span class=""><span class="">    request = </span><span class="hljs-keyword">await</span><span class=""> quart.request.get_json(force=</span><span class="hljs-literal">True</span><span class="">)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> username </span><span class="hljs-keyword">not</span><span class=""> </span><span class="hljs-keyword">in</span><span class=""> _TODOS:
</span></span><span class="">        _TODOS[username] = []
</span><span class=""><span class="">    _TODOS[username].append(request[</span><span class="hljs-string">"todo"</span><span class="">])
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=</span><span class="hljs-string">'OK'</span><span class="">, status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/todos/&lt;string:username&gt;"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">get_todos</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">username</span><span class="hljs-function">):</span><span class="">
</span></span><span class="">    assert_auth_header(quart.request)
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=json.dumps(_TODOS.get(username, [])), status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.delete(</span><span class="hljs-meta hljs-params hljs-string">"/todos/&lt;string:username&gt;"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">delete_todo</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">username</span><span class="hljs-function">):</span><span class="">
</span></span><span class="">    assert_auth_header(quart.request)
</span><span class=""><span class="">    request = </span><span class="hljs-keyword">await</span><span class=""> quart.request.get_json(force=</span><span class="hljs-literal">True</span><span class="">)
</span></span><span class=""><span class="">    todo_idx = request[</span><span class="hljs-string">"todo_idx"</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> </span><span class="hljs-number">0</span><span class=""> &lt;= todo_idx &lt; </span><span class="hljs-built_in">len</span><span class="">(_TODOS[username]):
</span></span><span class="">        _TODOS[username].pop(todo_idx)
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=</span><span class="hljs-string">'OK'</span><span class="">, status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/logo.png"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">plugin_logo</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    filename = </span><span class="hljs-string">'logo.png'</span><span class="">
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> </span><span class="hljs-keyword">await</span><span class=""> quart.send_file(filename, mimetype=</span><span class="hljs-string">'image/png'</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/.well-known/ai-plugin.json"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">plugin_manifest</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    host = request.headers[</span><span class="hljs-string">'Host'</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">with</span><span class=""> </span><span class="hljs-built_in">open</span><span class="">(</span><span class="hljs-string">"ai-plugin.json"</span><span class="">) </span><span class="hljs-keyword">as</span><span class=""> f:
</span></span><span class="">        text = f.read()
</span><span class=""><span class="">        </span><span class="hljs-keyword">return</span><span class=""> quart.Response(text, mimetype=</span><span class="hljs-string">"text/json"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/openapi.yaml"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">openapi_spec</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    host = request.headers[</span><span class="hljs-string">'Host'</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">with</span><span class=""> </span><span class="hljs-built_in">open</span><span class="">(</span><span class="hljs-string">"openapi.yaml"</span><span class="">) </span><span class="hljs-keyword">as</span><span class=""> f:
</span></span><span class="">        text = f.read()
</span><span class=""><span class="">        </span><span class="hljs-keyword">return</span><span class=""> quart.Response(text, mimetype=</span><span class="hljs-string">"text/yaml"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">main</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    app.run(debug=</span><span class="hljs-literal">True</span><span class="">, host=</span><span class="hljs-string">"0.0.0.0"</span><span class="">, port=</span><span class="hljs-number">5002</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-keyword">if</span><span class=""> __name__ == </span><span class="hljs-string">"__main__"</span><span class="">:
</span></span><span class="">    main()</span></code></pre></div></div><p>Last, we need to set up and define a OpenAPI specification to match the endpoints defined on our remote server. In general, the OpenAPI specification would look the same regardless of the authentication method. Using an automatic OpenAPI generator will reduce the chance of errors when creating your OpenAPI specification.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-yaml" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span><span class="react-syntax-highlighter-line-number">57
</span><span class="react-syntax-highlighter-line-number">58
</span><span class="react-syntax-highlighter-line-number">59
</span><span class="react-syntax-highlighter-line-number">60
</span><span class="react-syntax-highlighter-line-number">61
</span><span class="react-syntax-highlighter-line-number">62
</span><span class="react-syntax-highlighter-line-number">63
</span><span class="react-syntax-highlighter-line-number">64
</span><span class="react-syntax-highlighter-line-number">65
</span><span class="react-syntax-highlighter-line-number">66
</span><span class="react-syntax-highlighter-line-number">67
</span><span class="react-syntax-highlighter-line-number">68
</span><span class="react-syntax-highlighter-line-number">69
</span><span class="react-syntax-highlighter-line-number">70
</span><span class="react-syntax-highlighter-line-number">71
</span><span class="react-syntax-highlighter-line-number">72
</span><span class="react-syntax-highlighter-line-number">73
</span><span class="react-syntax-highlighter-line-number">74
</span><span class="react-syntax-highlighter-line-number">75
</span><span class="react-syntax-highlighter-line-number">76
</span><span class="react-syntax-highlighter-line-number">77
</span><span class="react-syntax-highlighter-line-number">78
</span><span class="react-syntax-highlighter-line-number">79
</span><span class="react-syntax-highlighter-line-number">80
</span><span class="react-syntax-highlighter-line-number">81
</span><span class="react-syntax-highlighter-line-number">82
</span><span class="react-syntax-highlighter-line-number">83
</span><span class="react-syntax-highlighter-line-number">84
</span><span class="react-syntax-highlighter-line-number">85
</span><span class="react-syntax-highlighter-line-number">86
</span><span class="react-syntax-highlighter-line-number">87
</span><span class="react-syntax-highlighter-line-number">88
</span><span class="react-syntax-highlighter-line-number">89
</span><span class="react-syntax-highlighter-line-number">90
</span><span class="react-syntax-highlighter-line-number">91
</span><span class="react-syntax-highlighter-line-number">92
</span><span class="react-syntax-highlighter-line-number">93
</span></code><span class=""><span class="">openapi: </span><span class="hljs-number">3.0</span><span class="hljs-number">.1</span><span class="">
</span></span><span class="">info:
</span><span class="">    title: TODO Plugin
</span><span class=""><span class="">    description: A plugin that allows the </span><span class="hljs-keyword">user</span><span class=""> </span><span class="hljs-keyword">to</span><span class=""> </span><span class="hljs-keyword">create</span><span class=""> </span><span class="hljs-keyword">and</span><span class=""> manage a TODO list </span><span class="hljs-keyword">using</span><span class=""> Ask Qx. If you do </span><span class="hljs-keyword">not</span><span class=""> know the </span><span class="hljs-keyword">user</span><span class="hljs-string">'s username, ask them first before making queries to the plugin. Otherwise, use the username "global".
</span></span><span class="hljs-string">    version: "v1"
</span><span class="hljs-string">servers:
</span><span class="hljs-string">    - url: https://example.com
</span><span class="hljs-string">paths:
</span><span class="hljs-string">    /todos/{username}:
</span><span class="hljs-string">        get:
</span><span class="hljs-string">            operationId: getTodos
</span><span class="hljs-string">            summary: Get the list of todos
</span><span class="hljs-string">            parameters:
</span><span class="hljs-string">                - in: path
</span><span class="hljs-string">                  name: username
</span><span class="hljs-string">                  schema:
</span><span class="hljs-string">                      type: string
</span><span class="hljs-string">                  required: true
</span><span class="hljs-string">                  description: The name of the user.
</span><span class="hljs-string">            responses:
</span><span class="hljs-string">                "200":
</span><span class="hljs-string">                    description: OK
</span><span class="hljs-string">                    content:
</span><span class="hljs-string">                        application/json:
</span><span class="hljs-string">                            schema:
</span><span class="hljs-string">                                $ref: "#/components/schemas/getTodosResponse"
</span><span class="hljs-string">        post:
</span><span class="hljs-string">            operationId: addTodo
</span><span class="hljs-string">            summary: Add a todo to the list
</span><span class="hljs-string">            parameters:
</span><span class="hljs-string">                - in: path
</span><span class="hljs-string">                  name: username
</span><span class="hljs-string">                  schema:
</span><span class="hljs-string">                      type: string
</span><span class="hljs-string">                  required: true
</span><span class="hljs-string">                  description: The name of the user.
</span><span class="hljs-string">            requestBody:
</span><span class="hljs-string">                required: true
</span><span class="hljs-string">                content:
</span><span class="hljs-string">                    application/json:
</span><span class="hljs-string">                        schema:
</span><span class="hljs-string">                            $ref: "#/components/schemas/addTodoRequest"
</span><span class="hljs-string">            responses:
</span><span class="hljs-string">                "200":
</span><span class="hljs-string">                    description: OK
</span><span class="hljs-string">        delete:
</span><span class="hljs-string">            operationId: deleteTodo
</span><span class="hljs-string">            summary: Delete a todo from the list
</span><span class="hljs-string">            parameters:
</span><span class="hljs-string">                - in: path
</span><span class="hljs-string">                  name: username
</span><span class="hljs-string">                  schema:
</span><span class="hljs-string">                      type: string
</span><span class="hljs-string">                  required: true
</span><span class="hljs-string">                  description: The name of the user.
</span><span class="hljs-string">            requestBody:
</span><span class="hljs-string">                required: true
</span><span class="hljs-string">                content:
</span><span class="hljs-string">                    application/json:
</span><span class="hljs-string">                        schema:
</span><span class="hljs-string">                            $ref: "#/components/schemas/deleteTodoRequest"
</span><span class="hljs-string">            responses:
</span><span class="hljs-string">                "200":
</span><span class="hljs-string">                    description: OK
</span><span class="hljs-string">
</span><span class="hljs-string">components:
</span><span class="hljs-string">    schemas:
</span><span class="hljs-string">        getTodosResponse:
</span><span class="hljs-string">            type: object
</span><span class="hljs-string">            properties:
</span><span class="hljs-string">                todos:
</span><span class="hljs-string">                    type: array
</span><span class="hljs-string">                    items:
</span><span class="hljs-string">                        type: string
</span><span class="hljs-string">                    description: The list of todos.
</span><span class="hljs-string">        addTodoRequest:
</span><span class="hljs-string">            type: object
</span><span class="hljs-string">            required:
</span><span class="hljs-string">                - todo
</span><span class="hljs-string">            properties:
</span><span class="hljs-string">                todo:
</span><span class="hljs-string">                    type: string
</span><span class="hljs-string">                    description: The todo to add to the list.
</span><span class="hljs-string">                    required: true
</span><span class="hljs-string">        deleteTodoRequest:
</span><span class="hljs-string">            type: object
</span><span class="hljs-string">            required:
</span><span class="hljs-string">                - todo_idx
</span><span class="hljs-string">            properties:
</span><span class="hljs-string">                todo_idx:
</span><span class="hljs-string">                    type: integer
</span><span class="hljs-string">                    description: The index of the todo to delete.
</span><span class="hljs-string">                    required: true</span></code></pre></div></div><div class="expn-collapse"><button tabindex="0" class="btn btn-sm btn-filled btn-neutral" type="button"><span class="btn-label-wrap"><span class="btn-label-inner">Collapse&zwj;</span></span></button></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-3"><div class="expn-icon"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"></path></svg></div><div class="expn-label">Learn how to build a simple sports stats plugin</div></div><div class="expn-content hidden" id="expander-3"><p>This plugin is an example of a simple sports stats API. Please keep in mind our domain policy and usage policies when considering what to build.</p><p>To start, define an <code>ai-plugin.json</code> file with the following fields:</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-json" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span></code><span class=""><span class="">{
</span></span><span class=""><span class="">    </span><span class="hljs-string">"schema_version"</span><span class="">: </span><span class="hljs-string">"v1"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"name_for_human"</span><span class="">: </span><span class="hljs-string">"Sport Stats"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"name_for_model"</span><span class="">: </span><span class="hljs-string">"sportStats"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"description_for_human"</span><span class="">: </span><span class="hljs-string">"Get current and historical stats for sport players and games."</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"description_for_model"</span><span class="">: </span><span class="hljs-string">"Get current and historical stats for sport players and games. Always display results using markdown tables."</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"auth"</span><span class="">: {
</span></span><span class=""><span class="">        </span><span class="hljs-string">"type"</span><span class="">: </span><span class="hljs-string">"none"</span><span class="">
</span></span><span class="">    },
</span><span class=""><span class="">    </span><span class="hljs-string">"api"</span><span class="">: {
</span></span><span class=""><span class="">        </span><span class="hljs-string">"type"</span><span class="">: </span><span class="hljs-string">"openapi"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"url"</span><span class="">: </span><span class="hljs-string">"PLUGIN_HOSTNAME/openapi.yaml"</span><span class="">
</span></span><span class="">    },
</span><span class=""><span class="">    </span><span class="hljs-string">"logo_url"</span><span class="">: </span><span class="hljs-string">"PLUGIN_HOSTNAME/logo.png"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"contact_email"</span><span class="">: </span><span class="hljs-string">"support@example.com"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"legal_info_url"</span><span class="">: </span><span class="hljs-string">"https://example.com/legal"</span><span class="">
</span></span><span class="">}</span></code></pre></div></div><p>Note the <code>PLUGIN_HOSTNAME</code> should be the actual hostname of your plugin server.</p><p>Next, we define a mock API for a simple sports service plugin.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-python" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span><span class="react-syntax-highlighter-line-number">57
</span><span class="react-syntax-highlighter-line-number">58
</span><span class="react-syntax-highlighter-line-number">59
</span><span class="react-syntax-highlighter-line-number">60
</span><span class="react-syntax-highlighter-line-number">61
</span><span class="react-syntax-highlighter-line-number">62
</span><span class="react-syntax-highlighter-line-number">63
</span><span class="react-syntax-highlighter-line-number">64
</span><span class="react-syntax-highlighter-line-number">65
</span><span class="react-syntax-highlighter-line-number">66
</span><span class="react-syntax-highlighter-line-number">67
</span><span class="react-syntax-highlighter-line-number">68
</span><span class="react-syntax-highlighter-line-number">69
</span><span class="react-syntax-highlighter-line-number">70
</span><span class="react-syntax-highlighter-line-number">71
</span><span class="react-syntax-highlighter-line-number">72
</span><span class="react-syntax-highlighter-line-number">73
</span><span class="react-syntax-highlighter-line-number">74
</span><span class="react-syntax-highlighter-line-number">75
</span><span class="react-syntax-highlighter-line-number">76
</span><span class="react-syntax-highlighter-line-number">77
</span><span class="react-syntax-highlighter-line-number">78
</span><span class="react-syntax-highlighter-line-number">79
</span><span class="react-syntax-highlighter-line-number">80
</span><span class="react-syntax-highlighter-line-number">81
</span><span class="react-syntax-highlighter-line-number">82
</span><span class="react-syntax-highlighter-line-number">83
</span><span class="react-syntax-highlighter-line-number">84
</span><span class="react-syntax-highlighter-line-number">85
</span><span class="react-syntax-highlighter-line-number">86
</span><span class="react-syntax-highlighter-line-number">87
</span><span class="react-syntax-highlighter-line-number">88
</span><span class="react-syntax-highlighter-line-number">89
</span><span class="react-syntax-highlighter-line-number">90
</span><span class="react-syntax-highlighter-line-number">91
</span><span class="react-syntax-highlighter-line-number">92
</span><span class="react-syntax-highlighter-line-number">93
</span><span class="react-syntax-highlighter-line-number">94
</span><span class="react-syntax-highlighter-line-number">95
</span><span class="react-syntax-highlighter-line-number">96
</span><span class="react-syntax-highlighter-line-number">97
</span><span class="react-syntax-highlighter-line-number">98
</span><span class="react-syntax-highlighter-line-number">99
</span><span class="react-syntax-highlighter-line-number">100
</span><span class="react-syntax-highlighter-line-number">101
</span><span class="react-syntax-highlighter-line-number">102
</span><span class="react-syntax-highlighter-line-number">103
</span><span class="react-syntax-highlighter-line-number">104
</span><span class="react-syntax-highlighter-line-number">105
</span><span class="react-syntax-highlighter-line-number">106
</span><span class="react-syntax-highlighter-line-number">107
</span><span class="react-syntax-highlighter-line-number">108
</span><span class="react-syntax-highlighter-line-number">109
</span><span class="react-syntax-highlighter-line-number">110
</span><span class="react-syntax-highlighter-line-number">111
</span><span class="react-syntax-highlighter-line-number">112
</span><span class="react-syntax-highlighter-line-number">113
</span><span class="react-syntax-highlighter-line-number">114
</span><span class="react-syntax-highlighter-line-number">115
</span><span class="react-syntax-highlighter-line-number">116
</span><span class="react-syntax-highlighter-line-number">117
</span><span class="react-syntax-highlighter-line-number">118
</span><span class="react-syntax-highlighter-line-number">119
</span><span class="react-syntax-highlighter-line-number">120
</span><span class="react-syntax-highlighter-line-number">121
</span><span class="react-syntax-highlighter-line-number">122
</span><span class="react-syntax-highlighter-line-number">123
</span><span class="react-syntax-highlighter-line-number">124
</span><span class="react-syntax-highlighter-line-number">125
</span><span class="react-syntax-highlighter-line-number">126
</span><span class="react-syntax-highlighter-line-number">127
</span><span class="react-syntax-highlighter-line-number">128
</span><span class="react-syntax-highlighter-line-number">129
</span><span class="react-syntax-highlighter-line-number">130
</span></code><span class=""><span class="hljs-keyword">import</span><span class=""> json
</span></span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> requests
</span></span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> urllib.parse
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> quart
</span></span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> quart_cors
</span></span><span class=""><span class=""></span><span class="hljs-keyword">from</span><span class=""> quart </span><span class="hljs-keyword">import</span><span class=""> request
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-comment"># Note: Setting CORS to allow chat.openapi.com is only required when running a localhost plugin</span><span class="">
</span></span><span class=""><span class="">app = quart_cors.cors(quart.Quart(__name__), allow_origin=</span><span class="hljs-string">"https://chat.qxlabai.com"</span><span class="">)
</span></span><span class=""><span class="">HOST_URL = </span><span class="hljs-string">"https://example.com"</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/players"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">get_players</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    query = request.args.get(</span><span class="hljs-string">"query"</span><span class="">)
</span></span><span class="">    res = requests.get(
</span><span class=""><span class="">        </span><span class="hljs-string">f"</span><span class="hljs-string hljs-subst">{HOST_URL}</span><span class="hljs-string">/api/v1/players?search=</span><span class="hljs-string hljs-subst">{query}</span><span class="hljs-string">&amp;page=0&amp;per_page=100"</span><span class="">)
</span></span><span class="">    body = res.json()
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=json.dumps(body), status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/teams"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">get_teams</span><span class="hljs-function">():</span><span class="">
</span></span><span class="">    res = requests.get(
</span><span class=""><span class="">        </span><span class="hljs-string">"{HOST_URL}/api/v1/teams?page=0&amp;per_page=100"</span><span class="">)
</span></span><span class="">    body = res.json()
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=json.dumps(body), status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/games"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">get_games</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    query_params = [(</span><span class="hljs-string">"page"</span><span class="">, </span><span class="hljs-string">"0"</span><span class="">)]
</span></span><span class=""><span class="">    limit = request.args.get(</span><span class="hljs-string">"limit"</span><span class="">)
</span></span><span class=""><span class="">    query_params.append((</span><span class="hljs-string">"per_page"</span><span class="">, limit </span><span class="hljs-keyword">or</span><span class=""> </span><span class="hljs-string">"100"</span><span class="">))
</span></span><span class=""><span class="">    start_date = request.args.get(</span><span class="hljs-string">"start_date"</span><span class="">)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> start_date:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"start_date"</span><span class="">, start_date))
</span></span><span class=""><span class="">    end_date = request.args.get(</span><span class="hljs-string">"end_date"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> end_date:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"end_date"</span><span class="">, end_date))
</span></span><span class=""><span class="">    seasons = request.args.getlist(</span><span class="hljs-string">"seasons"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class="">    </span><span class="hljs-keyword">for</span><span class=""> season </span><span class="hljs-keyword">in</span><span class=""> seasons:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"seasons[]"</span><span class="">, </span><span class="hljs-built_in">str</span><span class="">(season)))
</span></span><span class=""><span class="">    team_ids = request.args.getlist(</span><span class="hljs-string">"team_ids"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class="">    </span><span class="hljs-keyword">for</span><span class=""> team_id </span><span class="hljs-keyword">in</span><span class=""> team_ids:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"team_ids[]"</span><span class="">, </span><span class="hljs-built_in">str</span><span class="">(team_id)))
</span></span><span class="">
</span><span class="">    res = requests.get(
</span><span class=""><span class="">        </span><span class="hljs-string">f"</span><span class="hljs-string hljs-subst">{HOST_URL}</span><span class="hljs-string">/api/v1/games?</span><span class="hljs-string hljs-subst">{urllib.parse.urlencode(query_params)}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class="">    body = res.json()
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=json.dumps(body), status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/stats"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">get_stats</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    query_params = [(</span><span class="hljs-string">"page"</span><span class="">, </span><span class="hljs-string">"0"</span><span class="">)]
</span></span><span class=""><span class="">    limit = request.args.get(</span><span class="hljs-string">"limit"</span><span class="">)
</span></span><span class=""><span class="">    query_params.append((</span><span class="hljs-string">"per_page"</span><span class="">, limit </span><span class="hljs-keyword">or</span><span class=""> </span><span class="hljs-string">"100"</span><span class="">))
</span></span><span class=""><span class="">    start_date = request.args.get(</span><span class="hljs-string">"start_date"</span><span class="">)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> start_date:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"start_date"</span><span class="">, start_date))
</span></span><span class=""><span class="">    end_date = request.args.get(</span><span class="hljs-string">"end_date"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> end_date:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"end_date"</span><span class="">, end_date))
</span></span><span class=""><span class="">    player_ids = request.args.getlist(</span><span class="hljs-string">"player_ids"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class="">    </span><span class="hljs-keyword">for</span><span class=""> player_id </span><span class="hljs-keyword">in</span><span class=""> player_ids:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"player_ids[]"</span><span class="">, </span><span class="hljs-built_in">str</span><span class="">(player_id)))
</span></span><span class=""><span class="">    game_ids = request.args.getlist(</span><span class="hljs-string">"game_ids"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class="">    </span><span class="hljs-keyword">for</span><span class=""> game_id </span><span class="hljs-keyword">in</span><span class=""> game_ids:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"game_ids[]"</span><span class="">, </span><span class="hljs-built_in">str</span><span class="">(game_id)))
</span></span><span class="">    res = requests.get(
</span><span class=""><span class="">        </span><span class="hljs-string">f"</span><span class="hljs-string hljs-subst">{HOST_URL}</span><span class="hljs-string">/api/v1/stats?</span><span class="hljs-string hljs-subst">{urllib.parse.urlencode(query_params)}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class="">    body = res.json()
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=json.dumps(body), status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/season_averages"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">get_season_averages</span><span class="hljs-function">():</span><span class="">
</span></span><span class="">    query_params = []
</span><span class=""><span class="">    season = request.args.get(</span><span class="hljs-string">"season"</span><span class="">)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> season:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"season"</span><span class="">, </span><span class="hljs-built_in">str</span><span class="">(season)))
</span></span><span class=""><span class="">    player_ids = request.args.getlist(</span><span class="hljs-string">"player_ids"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class="">    </span><span class="hljs-keyword">for</span><span class=""> player_id </span><span class="hljs-keyword">in</span><span class=""> player_ids:
</span></span><span class=""><span class="">        query_params.append((</span><span class="hljs-string">"player_ids[]"</span><span class="">, </span><span class="hljs-built_in">str</span><span class="">(player_id)))
</span></span><span class="">    res = requests.get(
</span><span class=""><span class="">        </span><span class="hljs-string">f"</span><span class="hljs-string hljs-subst">{HOST_URL}</span><span class="hljs-string">/api/v1/season_averages?</span><span class="hljs-string hljs-subst">{urllib.parse.urlencode(query_params)}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class="">    body = res.json()
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=json.dumps(body), status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/logo.png"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">plugin_logo</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    filename = </span><span class="hljs-string">'logo.png'</span><span class="">
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> </span><span class="hljs-keyword">await</span><span class=""> quart.send_file(filename, mimetype=</span><span class="hljs-string">'image/png'</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/.well-known/ai-plugin.json"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">plugin_manifest</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    host = request.headers[</span><span class="hljs-string">'Host'</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">with</span><span class=""> </span><span class="hljs-built_in">open</span><span class="">(</span><span class="hljs-string">"ai-plugin.json"</span><span class="">) </span><span class="hljs-keyword">as</span><span class=""> f:
</span></span><span class="">        text = f.read()
</span><span class=""><span class="">        </span><span class="hljs-comment"># This is a trick we do to populate the PLUGIN_HOSTNAME constant in the manifest</span><span class="">
</span></span><span class=""><span class="">        text = text.replace(</span><span class="hljs-string">"PLUGIN_HOSTNAME"</span><span class="">, </span><span class="hljs-string">f"https://</span><span class="hljs-string hljs-subst">{host}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">return</span><span class=""> quart.Response(text, mimetype=</span><span class="hljs-string">"text/json"</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/openapi.yaml"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">openapi_spec</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    host = request.headers[</span><span class="hljs-string">'Host'</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">with</span><span class=""> </span><span class="hljs-built_in">open</span><span class="">(</span><span class="hljs-string">"openapi.yaml"</span><span class="">) </span><span class="hljs-keyword">as</span><span class=""> f:
</span></span><span class="">        text = f.read()
</span><span class=""><span class="">        </span><span class="hljs-comment"># This is a trick we do to populate the PLUGIN_HOSTNAME constant in the OpenAPI spec</span><span class="">
</span></span><span class=""><span class="">        text = text.replace(</span><span class="hljs-string">"PLUGIN_HOSTNAME"</span><span class="">, </span><span class="hljs-string">f"https://</span><span class="hljs-string hljs-subst">{host}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">return</span><span class=""> quart.Response(text, mimetype=</span><span class="hljs-string">"text/yaml"</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">main</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    app.run(debug=</span><span class="hljs-literal">True</span><span class="">, host=</span><span class="hljs-string">"0.0.0.0"</span><span class="">, port=</span><span class="hljs-number">5001</span><span class="">)
</span></span><span class="">
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-keyword">if</span><span class=""> __name__ == </span><span class="hljs-string">"__main__"</span><span class="">:
</span></span><span class="">    main()</span></code></pre></div></div><p>Last, we define our OpenAPI specification:</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-yaml" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span><span class="react-syntax-highlighter-line-number">57
</span><span class="react-syntax-highlighter-line-number">58
</span><span class="react-syntax-highlighter-line-number">59
</span><span class="react-syntax-highlighter-line-number">60
</span><span class="react-syntax-highlighter-line-number">61
</span><span class="react-syntax-highlighter-line-number">62
</span><span class="react-syntax-highlighter-line-number">63
</span><span class="react-syntax-highlighter-line-number">64
</span><span class="react-syntax-highlighter-line-number">65
</span><span class="react-syntax-highlighter-line-number">66
</span><span class="react-syntax-highlighter-line-number">67
</span><span class="react-syntax-highlighter-line-number">68
</span><span class="react-syntax-highlighter-line-number">69
</span><span class="react-syntax-highlighter-line-number">70
</span><span class="react-syntax-highlighter-line-number">71
</span><span class="react-syntax-highlighter-line-number">72
</span><span class="react-syntax-highlighter-line-number">73
</span><span class="react-syntax-highlighter-line-number">74
</span><span class="react-syntax-highlighter-line-number">75
</span><span class="react-syntax-highlighter-line-number">76
</span><span class="react-syntax-highlighter-line-number">77
</span><span class="react-syntax-highlighter-line-number">78
</span><span class="react-syntax-highlighter-line-number">79
</span><span class="react-syntax-highlighter-line-number">80
</span><span class="react-syntax-highlighter-line-number">81
</span><span class="react-syntax-highlighter-line-number">82
</span><span class="react-syntax-highlighter-line-number">83
</span><span class="react-syntax-highlighter-line-number">84
</span><span class="react-syntax-highlighter-line-number">85
</span><span class="react-syntax-highlighter-line-number">86
</span><span class="react-syntax-highlighter-line-number">87
</span><span class="react-syntax-highlighter-line-number">88
</span><span class="react-syntax-highlighter-line-number">89
</span><span class="react-syntax-highlighter-line-number">90
</span><span class="react-syntax-highlighter-line-number">91
</span><span class="react-syntax-highlighter-line-number">92
</span><span class="react-syntax-highlighter-line-number">93
</span><span class="react-syntax-highlighter-line-number">94
</span><span class="react-syntax-highlighter-line-number">95
</span><span class="react-syntax-highlighter-line-number">96
</span><span class="react-syntax-highlighter-line-number">97
</span><span class="react-syntax-highlighter-line-number">98
</span><span class="react-syntax-highlighter-line-number">99
</span><span class="react-syntax-highlighter-line-number">100
</span><span class="react-syntax-highlighter-line-number">101
</span><span class="react-syntax-highlighter-line-number">102
</span><span class="react-syntax-highlighter-line-number">103
</span><span class="react-syntax-highlighter-line-number">104
</span><span class="react-syntax-highlighter-line-number">105
</span><span class="react-syntax-highlighter-line-number">106
</span><span class="react-syntax-highlighter-line-number">107
</span><span class="react-syntax-highlighter-line-number">108
</span><span class="react-syntax-highlighter-line-number">109
</span><span class="react-syntax-highlighter-line-number">110
</span><span class="react-syntax-highlighter-line-number">111
</span><span class="react-syntax-highlighter-line-number">112
</span><span class="react-syntax-highlighter-line-number">113
</span><span class="react-syntax-highlighter-line-number">114
</span><span class="react-syntax-highlighter-line-number">115
</span><span class="react-syntax-highlighter-line-number">116
</span><span class="react-syntax-highlighter-line-number">117
</span><span class="react-syntax-highlighter-line-number">118
</span><span class="react-syntax-highlighter-line-number">119
</span><span class="react-syntax-highlighter-line-number">120
</span><span class="react-syntax-highlighter-line-number">121
</span><span class="react-syntax-highlighter-line-number">122
</span></code><span class=""><span class="">openapi: </span><span class="hljs-number">3.0</span><span class="hljs-number">.1</span><span class="">
</span></span><span class="">info:
</span><span class="">    title: Sport Stats
</span><span class=""><span class="">    description: </span><span class="hljs-keyword">Get</span><span class=""> </span><span class="hljs-keyword">current</span><span class=""> </span><span class="hljs-keyword">and</span><span class=""> historical stats </span><span class="hljs-keyword">for</span><span class=""> sport players </span><span class="hljs-keyword">and</span><span class=""> games.
</span></span><span class="">    version: "v1"
</span><span class="">servers:
</span><span class=""><span class="">    </span><span class="hljs-operator">-</span><span class=""> url: PLUGIN_HOSTNAME
</span></span><span class="">paths:
</span><span class=""><span class="">    </span><span class="hljs-operator">/</span><span class="">players:
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">get</span><span class="">:
</span></span><span class="">            operationId: getPlayers
</span><span class=""><span class="">            summary: Retrieves </span><span class="hljs-keyword">all</span><span class=""> players </span><span class="hljs-keyword">from</span><span class=""> </span><span class="hljs-keyword">all</span><span class=""> seasons whose names </span><span class="hljs-keyword">match</span><span class=""> the query string.
</span></span><span class="">            parameters:
</span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: query
</span><span class="">                  schema:
</span><span class="">                      type: string
</span><span class=""><span class="">                  description: Used </span><span class="hljs-keyword">to</span><span class=""> </span><span class="hljs-keyword">filter</span><span class=""> players based </span><span class="hljs-keyword">on</span><span class=""> their name. </span><span class="hljs-keyword">For</span><span class=""> example, ?query</span><span class="hljs-operator">=</span><span class="">davis will </span><span class="hljs-keyword">return</span><span class=""> players that have </span><span class="hljs-string">'davis'</span><span class=""> </span><span class="hljs-keyword">in</span><span class=""> their </span><span class="hljs-keyword">first</span><span class=""> </span><span class="hljs-keyword">or</span><span class=""> </span><span class="hljs-keyword">last</span><span class=""> name.
</span></span><span class="">            responses:
</span><span class="">                "200":
</span><span class="">                    description: OK
</span><span class=""><span class="">    </span><span class="hljs-operator">/</span><span class="">teams:
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">get</span><span class="">:
</span></span><span class="">            operationId: getTeams
</span><span class=""><span class="">            summary: Retrieves </span><span class="hljs-keyword">all</span><span class=""> teams </span><span class="hljs-keyword">for</span><span class=""> the </span><span class="hljs-keyword">current</span><span class=""> season.
</span></span><span class="">            responses:
</span><span class="">                "200":
</span><span class="">                    description: OK
</span><span class=""><span class="">    </span><span class="hljs-operator">/</span><span class="">games:
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">get</span><span class="">:
</span></span><span class="">            operationId: getGames
</span><span class=""><span class="">            summary: Retrieves </span><span class="hljs-keyword">all</span><span class=""> games that </span><span class="hljs-keyword">match</span><span class=""> the filters specified </span><span class="hljs-keyword">by</span><span class=""> the args. Display results </span><span class="hljs-keyword">using</span><span class=""> markdown tables.
</span></span><span class="">            parameters:
</span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: limit
</span><span class="">                  schema:
</span><span class="">                      type: string
</span><span class=""><span class="">                  description: The max number </span><span class="hljs-keyword">of</span><span class=""> results </span><span class="hljs-keyword">to</span><span class=""> return.
</span></span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: seasons
</span><span class="">                  schema:
</span><span class=""><span class="">                      type: </span><span class="hljs-keyword">array</span><span class="">
</span></span><span class="">                      items:
</span><span class="">                          type: string
</span><span class=""><span class="">                  description: </span><span class="hljs-keyword">Filter</span><span class=""> </span><span class="hljs-keyword">by</span><span class=""> seasons. Seasons </span><span class="hljs-keyword">are</span><span class=""> represented </span><span class="hljs-keyword">by</span><span class=""> the </span><span class="hljs-keyword">year</span><span class=""> they began. </span><span class="hljs-keyword">For</span><span class=""> example, </span><span class="hljs-number">2018</span><span class=""> represents season </span><span class="hljs-number">2018</span><span class="hljs-number">-2019.</span><span class="">
</span></span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: team_ids
</span><span class="">                  schema:
</span><span class=""><span class="">                      type: </span><span class="hljs-keyword">array</span><span class="">
</span></span><span class="">                      items:
</span><span class="">                          type: string
</span><span class=""><span class="">                  description: </span><span class="hljs-keyword">Filter</span><span class=""> </span><span class="hljs-keyword">by</span><span class=""> team ids. Team ids can be determined </span><span class="hljs-keyword">using</span><span class=""> the getTeams function.
</span></span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: start_date
</span><span class="">                  schema:
</span><span class="">                      type: string
</span><span class=""><span class="">                  description: A single </span><span class="hljs-type">date</span><span class=""> </span><span class="hljs-keyword">in</span><span class=""> </span><span class="hljs-string">'YYYY-MM-DD'</span><span class=""> format. This </span><span class="hljs-keyword">is</span><span class=""> used </span><span class="hljs-keyword">to</span><span class=""> </span><span class="hljs-keyword">select</span><span class=""> games that occur </span><span class="hljs-keyword">on</span><span class=""> </span><span class="hljs-keyword">or</span><span class=""> after this date.
</span></span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: end_date
</span><span class="">                  schema:
</span><span class="">                      type: string
</span><span class=""><span class="">                  description: A single </span><span class="hljs-type">date</span><span class=""> </span><span class="hljs-keyword">in</span><span class=""> </span><span class="hljs-string">'YYYY-MM-DD'</span><span class=""> format. This </span><span class="hljs-keyword">is</span><span class=""> used </span><span class="hljs-keyword">to</span><span class=""> </span><span class="hljs-keyword">select</span><span class=""> games that occur </span><span class="hljs-keyword">on</span><span class=""> </span><span class="hljs-keyword">or</span><span class=""> before this date.
</span></span><span class="">            responses:
</span><span class="">                "200":
</span><span class="">                    description: OK
</span><span class=""><span class="">    </span><span class="hljs-operator">/</span><span class="">stats:
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">get</span><span class="">:
</span></span><span class="">            operationId: getStats
</span><span class=""><span class="">            summary: Retrieves stats that </span><span class="hljs-keyword">match</span><span class=""> the filters specified </span><span class="hljs-keyword">by</span><span class=""> the args. Display results </span><span class="hljs-keyword">using</span><span class=""> markdown tables.
</span></span><span class="">            parameters:
</span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: limit
</span><span class="">                  schema:
</span><span class="">                      type: string
</span><span class=""><span class="">                  description: The max number </span><span class="hljs-keyword">of</span><span class=""> results </span><span class="hljs-keyword">to</span><span class=""> return.
</span></span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: player_ids
</span><span class="">                  schema:
</span><span class=""><span class="">                      type: </span><span class="hljs-keyword">array</span><span class="">
</span></span><span class="">                      items:
</span><span class="">                          type: string
</span><span class=""><span class="">                  description: </span><span class="hljs-keyword">Filter</span><span class=""> </span><span class="hljs-keyword">by</span><span class=""> player ids. Player ids can be determined </span><span class="hljs-keyword">using</span><span class=""> the getPlayers function.
</span></span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: game_ids
</span><span class="">                  schema:
</span><span class=""><span class="">                      type: </span><span class="hljs-keyword">array</span><span class="">
</span></span><span class="">                      items:
</span><span class="">                          type: string
</span><span class=""><span class="">                  description: </span><span class="hljs-keyword">Filter</span><span class=""> </span><span class="hljs-keyword">by</span><span class=""> game ids. Game ids can be determined </span><span class="hljs-keyword">using</span><span class=""> the getGames function.
</span></span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: start_date
</span><span class="">                  schema:
</span><span class="">                      type: string
</span><span class=""><span class="">                  description: A single </span><span class="hljs-type">date</span><span class=""> </span><span class="hljs-keyword">in</span><span class=""> </span><span class="hljs-string">'YYYY-MM-DD'</span><span class=""> format. This </span><span class="hljs-keyword">is</span><span class=""> used </span><span class="hljs-keyword">to</span><span class=""> </span><span class="hljs-keyword">select</span><span class=""> games that occur </span><span class="hljs-keyword">on</span><span class=""> </span><span class="hljs-keyword">or</span><span class=""> after this date.
</span></span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: end_date
</span><span class="">                  schema:
</span><span class="">                      type: string
</span><span class=""><span class="">                  description: A single </span><span class="hljs-type">date</span><span class=""> </span><span class="hljs-keyword">in</span><span class=""> </span><span class="hljs-string">'YYYY-MM-DD'</span><span class=""> format. This </span><span class="hljs-keyword">is</span><span class=""> used </span><span class="hljs-keyword">to</span><span class=""> </span><span class="hljs-keyword">select</span><span class=""> games that occur </span><span class="hljs-keyword">on</span><span class=""> </span><span class="hljs-keyword">or</span><span class=""> before this date.
</span></span><span class="">            responses:
</span><span class="">                "200":
</span><span class="">                    description: OK
</span><span class=""><span class="">    </span><span class="hljs-operator">/</span><span class="">season_averages:
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">get</span><span class="">:
</span></span><span class="">            operationId: getSeasonAverages
</span><span class=""><span class="">            summary: Retrieves regular season averages </span><span class="hljs-keyword">for</span><span class=""> the given players. Display results </span><span class="hljs-keyword">using</span><span class=""> markdown tables.
</span></span><span class="">            parameters:
</span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: season
</span><span class="">                  schema:
</span><span class="">                      type: string
</span><span class=""><span class="">                  description: Defaults </span><span class="hljs-keyword">to</span><span class=""> the </span><span class="hljs-keyword">current</span><span class=""> season. A season </span><span class="hljs-keyword">is</span><span class=""> represented </span><span class="hljs-keyword">by</span><span class=""> the </span><span class="hljs-keyword">year</span><span class=""> it began. </span><span class="hljs-keyword">For</span><span class=""> example, </span><span class="hljs-number">2018</span><span class=""> represents season </span><span class="hljs-number">2018</span><span class="hljs-number">-2019.</span><span class="">
</span></span><span class=""><span class="">                </span><span class="hljs-operator">-</span><span class=""> </span><span class="hljs-keyword">in</span><span class="">: query
</span></span><span class="">                  name: player_ids
</span><span class="">                  schema:
</span><span class=""><span class="">                      type: </span><span class="hljs-keyword">array</span><span class="">
</span></span><span class="">                      items:
</span><span class="">                          type: string
</span><span class=""><span class="">                  description: </span><span class="hljs-keyword">Filter</span><span class=""> </span><span class="hljs-keyword">by</span><span class=""> player ids. Player ids can be determined </span><span class="hljs-keyword">using</span><span class=""> the getPlayers function.
</span></span><span class="">            responses:
</span><span class="">                "200":
</span><span class="">                    description: OK</span></code></pre></div></div><div class="expn-collapse"><button tabindex="0" class="btn btn-sm btn-filled btn-neutral" type="button"><span class="btn-label-wrap"><span class="btn-label-inner">Collapse&zwj;</span></span></button></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-4"><div class="expn-icon"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"></path></svg></div><div class="expn-label">Learn how to build a simple OAuth todo list plugin</div></div><div class="expn-content hidden" id="expander-4"><p>To create an OAuth plugin, we start by defining a <code>ai-plugin.json</code> file with the auth type set to <code>oauth</code>:</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-json" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span></code><span class=""><span class="">{
</span></span><span class=""><span class="">    </span><span class="hljs-string">"schema_version"</span><span class="">: </span><span class="hljs-string">"v1"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"name_for_human"</span><span class="">: </span><span class="hljs-string">"TODO List (OAuth)"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"name_for_model"</span><span class="">: </span><span class="hljs-string">"todo_oauth"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"description_for_human"</span><span class="">: </span><span class="hljs-string">"Manage your TODO list. You can add, remove and view your TODOs."</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"description_for_model"</span><span class="">: </span><span class="hljs-string">"Plugin for managing a TODO list, you can add, remove and view your TODOs."</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"auth"</span><span class="">: {
</span></span><span class=""><span class="">        </span><span class="hljs-string">"type"</span><span class="">: </span><span class="hljs-string">"oauth"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"client_url"</span><span class="">: </span><span class="hljs-string">"PLUGIN_HOSTNAME/oauth"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"scope"</span><span class="">: </span><span class="hljs-string">""</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"authorization_url"</span><span class="">: </span><span class="hljs-string">"PLUGIN_HOSTNAME/auth/oauth_exchange"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"authorization_content_type"</span><span class="">: </span><span class="hljs-string">"application/json"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"verification_tokens"</span><span class="">: {
</span></span><span class=""><span class="">            </span><span class="hljs-string">"QX LabAI"</span><span class="">: </span><span class="hljs-string">"Replace_this_string_with_the_verification_token_generated_in_the_Ask Qx_UI"</span><span class="">
</span></span><span class="">        }
</span><span class="">    },
</span><span class=""><span class="">    </span><span class="hljs-string">"api"</span><span class="">: {
</span></span><span class=""><span class="">        </span><span class="hljs-string">"type"</span><span class="">: </span><span class="hljs-string">"openapi"</span><span class="">,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"url"</span><span class="">: </span><span class="hljs-string">"PLUGIN_HOSTNAME/openapi.yaml"</span><span class="">
</span></span><span class="">    },
</span><span class=""><span class="">    </span><span class="hljs-string">"logo_url"</span><span class="">: </span><span class="hljs-string">"PLUGIN_HOSTNAME/logo.png"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"contact_email"</span><span class="">: </span><span class="hljs-string">"contact@example.com"</span><span class="">,
</span></span><span class=""><span class="">    </span><span class="hljs-string">"legal_info_url"</span><span class="">: </span><span class="hljs-string">"http://www.example.com/legal"</span><span class="">
</span></span><span class="">}</span></code></pre></div></div><p>Next, we need to define our OAuth service. This OAuth example is not intended for production use cases but rather to highlight what a simple OAuth flow will look like so developers can get experience building towards a production solution.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-python" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span><span class="react-syntax-highlighter-line-number">57
</span><span class="react-syntax-highlighter-line-number">58
</span><span class="react-syntax-highlighter-line-number">59
</span><span class="react-syntax-highlighter-line-number">60
</span><span class="react-syntax-highlighter-line-number">61
</span><span class="react-syntax-highlighter-line-number">62
</span><span class="react-syntax-highlighter-line-number">63
</span><span class="react-syntax-highlighter-line-number">64
</span><span class="react-syntax-highlighter-line-number">65
</span><span class="react-syntax-highlighter-line-number">66
</span><span class="react-syntax-highlighter-line-number">67
</span><span class="react-syntax-highlighter-line-number">68
</span><span class="react-syntax-highlighter-line-number">69
</span><span class="react-syntax-highlighter-line-number">70
</span><span class="react-syntax-highlighter-line-number">71
</span><span class="react-syntax-highlighter-line-number">72
</span><span class="react-syntax-highlighter-line-number">73
</span><span class="react-syntax-highlighter-line-number">74
</span><span class="react-syntax-highlighter-line-number">75
</span><span class="react-syntax-highlighter-line-number">76
</span><span class="react-syntax-highlighter-line-number">77
</span><span class="react-syntax-highlighter-line-number">78
</span><span class="react-syntax-highlighter-line-number">79
</span><span class="react-syntax-highlighter-line-number">80
</span><span class="react-syntax-highlighter-line-number">81
</span><span class="react-syntax-highlighter-line-number">82
</span><span class="react-syntax-highlighter-line-number">83
</span><span class="react-syntax-highlighter-line-number">84
</span><span class="react-syntax-highlighter-line-number">85
</span><span class="react-syntax-highlighter-line-number">86
</span><span class="react-syntax-highlighter-line-number">87
</span><span class="react-syntax-highlighter-line-number">88
</span><span class="react-syntax-highlighter-line-number">89
</span><span class="react-syntax-highlighter-line-number">90
</span><span class="react-syntax-highlighter-line-number">91
</span><span class="react-syntax-highlighter-line-number">92
</span><span class="react-syntax-highlighter-line-number">93
</span><span class="react-syntax-highlighter-line-number">94
</span><span class="react-syntax-highlighter-line-number">95
</span><span class="react-syntax-highlighter-line-number">96
</span><span class="react-syntax-highlighter-line-number">97
</span></code><span class=""><span class="hljs-keyword">import</span><span class=""> json
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> quart
</span></span><span class=""><span class=""></span><span class="hljs-keyword">import</span><span class=""> quart_cors
</span></span><span class=""><span class=""></span><span class="hljs-keyword">from</span><span class=""> quart </span><span class="hljs-keyword">import</span><span class=""> request
</span></span><span class="">
</span><span class=""><span class="">app = quart_cors.cors(quart.Quart(__name__), allow_origin=</span><span class="hljs-string">"*"</span><span class="">)
</span></span><span class="">
</span><span class="">_TODOS = {}
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.post(</span><span class="hljs-meta hljs-params hljs-string">"/todos/&lt;string:username&gt;"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">add_todo</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">username</span><span class="hljs-function">):</span><span class="">
</span></span><span class=""><span class="">    request = </span><span class="hljs-keyword">await</span><span class=""> quart.request.get_json(force=</span><span class="hljs-literal">True</span><span class="">)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> username </span><span class="hljs-keyword">not</span><span class=""> </span><span class="hljs-keyword">in</span><span class=""> _TODOS:
</span></span><span class="">        _TODOS[username] = []
</span><span class=""><span class="">    _TODOS[username].append(request[</span><span class="hljs-string">"todo"</span><span class="">])
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=</span><span class="hljs-string">'OK'</span><span class="">, status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/todos/&lt;string:username&gt;"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">get_todos</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">username</span><span class="hljs-function">):</span><span class="">
</span></span><span class=""><span class="">    </span><span class="hljs-built_in">print</span><span class="">(request.headers)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=json.dumps(_TODOS.get(username, [])), status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.delete(</span><span class="hljs-meta hljs-params hljs-string">"/todos/&lt;string:username&gt;"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">delete_todo</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">username</span><span class="hljs-function">):</span><span class="">
</span></span><span class=""><span class="">    request = </span><span class="hljs-keyword">await</span><span class=""> quart.request.get_json(force=</span><span class="hljs-literal">True</span><span class="">)
</span></span><span class=""><span class="">    todo_idx = request[</span><span class="hljs-string">"todo_idx"</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-comment"># fail silently, it's a simple plugin</span><span class="">
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> </span><span class="hljs-number">0</span><span class=""> &lt;= todo_idx &lt; </span><span class="hljs-built_in">len</span><span class="">(_TODOS[username]):
</span></span><span class="">        _TODOS[username].pop(todo_idx)
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(response=</span><span class="hljs-string">'OK'</span><span class="">, status=</span><span class="hljs-number">200</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/logo.png"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">plugin_logo</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    filename = </span><span class="hljs-string">'logo.png'</span><span class="">
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> </span><span class="hljs-keyword">await</span><span class=""> quart.send_file(filename, mimetype=</span><span class="hljs-string">'image/png'</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/.well-known/ai-plugin.json"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">plugin_manifest</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    host = request.headers[</span><span class="hljs-string">'Host'</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">with</span><span class=""> </span><span class="hljs-built_in">open</span><span class="">(</span><span class="hljs-string">"manifest.json"</span><span class="">) </span><span class="hljs-keyword">as</span><span class=""> f:
</span></span><span class="">        text = f.read()
</span><span class=""><span class="">        text = text.replace(</span><span class="hljs-string">"PLUGIN_HOSTNAME"</span><span class="">, </span><span class="hljs-string">f"https://</span><span class="hljs-string hljs-subst">{host}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">return</span><span class=""> quart.Response(text, mimetype=</span><span class="hljs-string">"text/json"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/openapi.yaml"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">openapi_spec</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    host = request.headers[</span><span class="hljs-string">'Host'</span><span class="">]
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">with</span><span class=""> </span><span class="hljs-built_in">open</span><span class="">(</span><span class="hljs-string">"openapi.yaml"</span><span class="">) </span><span class="hljs-keyword">as</span><span class=""> f:
</span></span><span class="">        text = f.read()
</span><span class=""><span class="">        text = text.replace(</span><span class="hljs-string">"PLUGIN_HOSTNAME"</span><span class="">, </span><span class="hljs-string">f"https://</span><span class="hljs-string hljs-subst">{host}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">return</span><span class=""> quart.Response(text, mimetype=</span><span class="hljs-string">"text/yaml"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.get(</span><span class="hljs-meta hljs-params hljs-string">"/oauth"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">oauth</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    query_string = request.query_string.decode(</span><span class="hljs-string">'utf-8'</span><span class="">)
</span></span><span class=""><span class="">    parts = query_string.split(</span><span class="hljs-string">'&amp;'</span><span class="">)
</span></span><span class="">    kvps = {}
</span><span class=""><span class="">    </span><span class="hljs-keyword">for</span><span class=""> part </span><span class="hljs-keyword">in</span><span class=""> parts:
</span></span><span class=""><span class="">        k, v = part.split(</span><span class="hljs-string">'='</span><span class="">)
</span></span><span class=""><span class="">        v = v.replace(</span><span class="hljs-string">"%2F"</span><span class="">, </span><span class="hljs-string">"/"</span><span class="">).replace(</span><span class="hljs-string">"%3A"</span><span class="">, </span><span class="hljs-string">":"</span><span class="">)
</span></span><span class="">        kvps[k] = v
</span><span class=""><span class="">    </span><span class="hljs-built_in">print</span><span class="">(</span><span class="hljs-string">"OAuth key value pairs from the Ask Qx Request: "</span><span class="">, kvps)
</span></span><span class=""><span class="">    url = kvps[</span><span class="hljs-string">"redirect_uri"</span><span class="">] + </span><span class="hljs-string">f"?code=</span><span class="hljs-string hljs-subst">{QX LabAI_CODE}</span><span class="hljs-string">"</span><span class="">
</span></span><span class=""><span class="">    </span><span class="hljs-built_in">print</span><span class="">(</span><span class="hljs-string">"URL: "</span><span class="">, url)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> quart.Response(
</span></span><span class=""><span class="">        </span><span class="hljs-string">f'&lt;a href="</span><span class="hljs-string hljs-subst">{url}</span><span class="hljs-string">"&gt;Click to authorize&lt;/a&gt;'</span><span class="">
</span></span><span class="">    )
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-comment"># Sample names</span><span class="">
</span></span><span class=""><span class="">QX LabAI_CLIENT_ID = </span><span class="hljs-string">"id"</span><span class="">
</span></span><span class=""><span class="">QX LabAI_CLIENT_SECRET = </span><span class="hljs-string">"secret"</span><span class="">
</span></span><span class=""><span class="">QX LabAI_CODE = </span><span class="hljs-string">"abc123"</span><span class="">
</span></span><span class=""><span class="">QX LabAI_TOKEN = </span><span class="hljs-string">"def456"</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-meta">@app.post(</span><span class="hljs-meta hljs-params hljs-string">"/auth/oauth_exchange"</span><span class="hljs-meta">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="hljs-keyword">async</span><span class=""> </span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">oauth_exchange</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    request = </span><span class="hljs-keyword">await</span><span class=""> quart.request.get_json(force=</span><span class="hljs-literal">True</span><span class="">)
</span></span><span class=""><span class="">    </span><span class="hljs-built_in">print</span><span class="">(</span><span class="hljs-string">f"oauth_exchange </span><span class="hljs-string hljs-subst">{request=}</span><span class="hljs-string">"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> request[</span><span class="hljs-string">"client_id"</span><span class="">] != QX LabAI_CLIENT_ID:
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">raise</span><span class=""> RuntimeError(</span><span class="hljs-string">"bad client ID"</span><span class="">)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> request[</span><span class="hljs-string">"client_secret"</span><span class="">] != QX LabAI_CLIENT_SECRET:
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">raise</span><span class=""> RuntimeError(</span><span class="hljs-string">"bad client secret"</span><span class="">)
</span></span><span class=""><span class="">    </span><span class="hljs-keyword">if</span><span class=""> request[</span><span class="hljs-string">"code"</span><span class="">] != QX LabAI_CODE:
</span></span><span class=""><span class="">        </span><span class="hljs-keyword">raise</span><span class=""> RuntimeError(</span><span class="hljs-string">"bad code"</span><span class="">)
</span></span><span class="">
</span><span class=""><span class="">    </span><span class="hljs-keyword">return</span><span class=""> {
</span></span><span class=""><span class="">        </span><span class="hljs-string">"access_token"</span><span class="">: QX LabAI_TOKEN,
</span></span><span class=""><span class="">        </span><span class="hljs-string">"token_type"</span><span class="">: </span><span class="hljs-string">"bearer"</span><span class="">
</span></span><span class="">    }
</span><span class="">
</span><span class=""><span class=""></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">main</span><span class="hljs-function">():</span><span class="">
</span></span><span class=""><span class="">    app.run(debug=</span><span class="hljs-literal">True</span><span class="">, host=</span><span class="hljs-string">"0.0.0.0"</span><span class="">, port=</span><span class="hljs-number">5002</span><span class="">)
</span></span><span class="">
</span><span class=""><span class=""></span><span class="hljs-keyword">if</span><span class=""> __name__ == </span><span class="hljs-string">"__main__"</span><span class="">:
</span></span><span class="">    main()</span></code></pre></div></div><p>Last, like with our other examples, we define a simple OpenAPI file based on the endpoints:</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float copy-btn-top " type="button" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark code-sample-pre"><code class="language-yaml" style="white-space: pre;"><code><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span><span class="react-syntax-highlighter-line-number">57
</span><span class="react-syntax-highlighter-line-number">58
</span><span class="react-syntax-highlighter-line-number">59
</span><span class="react-syntax-highlighter-line-number">60
</span><span class="react-syntax-highlighter-line-number">61
</span><span class="react-syntax-highlighter-line-number">62
</span><span class="react-syntax-highlighter-line-number">63
</span><span class="react-syntax-highlighter-line-number">64
</span><span class="react-syntax-highlighter-line-number">65
</span><span class="react-syntax-highlighter-line-number">66
</span><span class="react-syntax-highlighter-line-number">67
</span><span class="react-syntax-highlighter-line-number">68
</span><span class="react-syntax-highlighter-line-number">69
</span><span class="react-syntax-highlighter-line-number">70
</span><span class="react-syntax-highlighter-line-number">71
</span><span class="react-syntax-highlighter-line-number">72
</span><span class="react-syntax-highlighter-line-number">73
</span><span class="react-syntax-highlighter-line-number">74
</span><span class="react-syntax-highlighter-line-number">75
</span><span class="react-syntax-highlighter-line-number">76
</span><span class="react-syntax-highlighter-line-number">77
</span><span class="react-syntax-highlighter-line-number">78
</span><span class="react-syntax-highlighter-line-number">79
</span><span class="react-syntax-highlighter-line-number">80
</span><span class="react-syntax-highlighter-line-number">81
</span><span class="react-syntax-highlighter-line-number">82
</span><span class="react-syntax-highlighter-line-number">83
</span><span class="react-syntax-highlighter-line-number">84
</span><span class="react-syntax-highlighter-line-number">85
</span><span class="react-syntax-highlighter-line-number">86
</span><span class="react-syntax-highlighter-line-number">87
</span><span class="react-syntax-highlighter-line-number">88
</span><span class="react-syntax-highlighter-line-number">89
</span><span class="react-syntax-highlighter-line-number">90
</span><span class="react-syntax-highlighter-line-number">91
</span><span class="react-syntax-highlighter-line-number">92
</span><span class="react-syntax-highlighter-line-number">93
</span></code><span class=""><span class="">openapi: </span><span class="hljs-number">3.0</span><span class="hljs-number">.1</span><span class="">
</span></span><span class="">info:
</span><span class="">    title: TODO Plugin
</span><span class=""><span class="">    description: A plugin that allows the </span><span class="hljs-keyword">user</span><span class=""> </span><span class="hljs-keyword">to</span><span class=""> </span><span class="hljs-keyword">create</span><span class=""> </span><span class="hljs-keyword">and</span><span class=""> manage a TODO list </span><span class="hljs-keyword">using</span><span class=""> Ask Qx. If you do </span><span class="hljs-keyword">not</span><span class=""> know the </span><span class="hljs-keyword">user</span><span class="hljs-string">'s username, ask them first before making queries to the plugin. Otherwise, use the username "global".
</span></span><span class="hljs-string">    version: "v1"
</span><span class="hljs-string">servers:
</span><span class="hljs-string">    - url: PLUGIN_HOSTNAME
</span><span class="hljs-string">paths:
</span><span class="hljs-string">    /todos/{username}:
</span><span class="hljs-string">        get:
</span><span class="hljs-string">            operationId: getTodos
</span><span class="hljs-string">            summary: Get the list of todos
</span><span class="hljs-string">            parameters:
</span><span class="hljs-string">                - in: path
</span><span class="hljs-string">                  name: username
</span><span class="hljs-string">                  schema:
</span><span class="hljs-string">                      type: string
</span><span class="hljs-string">                  required: true
</span><span class="hljs-string">                  description: The name of the user.
</span><span class="hljs-string">            responses:
</span><span class="hljs-string">                "200":
</span><span class="hljs-string">                    description: OK
</span><span class="hljs-string">                    content:
</span><span class="hljs-string">                        application/json:
</span><span class="hljs-string">                            schema:
</span><span class="hljs-string">                                $ref: "#/components/schemas/getTodosResponse"
</span><span class="hljs-string">        post:
</span><span class="hljs-string">            operationId: addTodo
</span><span class="hljs-string">            summary: Add a todo to the list
</span><span class="hljs-string">            parameters:
</span><span class="hljs-string">                - in: path
</span><span class="hljs-string">                  name: username
</span><span class="hljs-string">                  schema:
</span><span class="hljs-string">                      type: string
</span><span class="hljs-string">                  required: true
</span><span class="hljs-string">                  description: The name of the user.
</span><span class="hljs-string">            requestBody:
</span><span class="hljs-string">                required: true
</span><span class="hljs-string">                content:
</span><span class="hljs-string">                    application/json:
</span><span class="hljs-string">                        schema:
</span><span class="hljs-string">                            $ref: "#/components/schemas/addTodoRequest"
</span><span class="hljs-string">            responses:
</span><span class="hljs-string">                "200":
</span><span class="hljs-string">                    description: OK
</span><span class="hljs-string">        delete:
</span><span class="hljs-string">            operationId: deleteTodo
</span><span class="hljs-string">            summary: Delete a todo from the list
</span><span class="hljs-string">            parameters:
</span><span class="hljs-string">                - in: path
</span><span class="hljs-string">                  name: username
</span><span class="hljs-string">                  schema:
</span><span class="hljs-string">                      type: string
</span><span class="hljs-string">                  required: true
</span><span class="hljs-string">                  description: The name of the user.
</span><span class="hljs-string">            requestBody:
</span><span class="hljs-string">                required: true
</span><span class="hljs-string">                content:
</span><span class="hljs-string">                    application/json:
</span><span class="hljs-string">                        schema:
</span><span class="hljs-string">                            $ref: "#/components/schemas/deleteTodoRequest"
</span><span class="hljs-string">            responses:
</span><span class="hljs-string">                "200":
</span><span class="hljs-string">                    description: OK
</span><span class="hljs-string">
</span><span class="hljs-string">components:
</span><span class="hljs-string">    schemas:
</span><span class="hljs-string">        getTodosResponse:
</span><span class="hljs-string">            type: object
</span><span class="hljs-string">            properties:
</span><span class="hljs-string">                todos:
</span><span class="hljs-string">                    type: array
</span><span class="hljs-string">                    items:
</span><span class="hljs-string">                        type: string
</span><span class="hljs-string">                    description: The list of todos.
</span><span class="hljs-string">        addTodoRequest:
</span><span class="hljs-string">            type: object
</span><span class="hljs-string">            required:
</span><span class="hljs-string">                - todo
</span><span class="hljs-string">            properties:
</span><span class="hljs-string">                todo:
</span><span class="hljs-string">                    type: string
</span><span class="hljs-string">                    description: The todo to add to the list.
</span><span class="hljs-string">                    required: true
</span><span class="hljs-string">        deleteTodoRequest:
</span><span class="hljs-string">            type: object
</span><span class="hljs-string">            required:
</span><span class="hljs-string">                - todo_idx
</span><span class="hljs-string">            properties:
</span><span class="hljs-string">                todo_idx:
</span><span class="hljs-string">                    type: integer
</span><span class="hljs-string">                    description: The index of the todo to delete.
</span><span class="hljs-string">                    required: true</span></code></pre></div></div><div class="expn-collapse"><button tabindex="0" class="btn btn-sm btn-filled btn-neutral" type="button"><span class="btn-label-wrap"><span class="btn-label-inner">Collapse&zwj;</span></span></button></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-5"><div class="expn-icon"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"></path></svg></div><div class="expn-label">Learn how to build a semantic search and retrieval plugin</div></div><div class="expn-content hidden" id="expander-5"><p>The <a href="https://github.com/QX LabAI/Ask Qx-retrieval-plugin" target="_blank" rel="noopener noreferrer">Ask Qx retrieval plugin</a> is a more fully featured code example. The scope of the plugin is large, so we encourage you to read through the code to see what a more advanced plugin looks like.</p><p>The retrieval plugin includes:</p><ul><li>Support for multiple vector databases providers</li><li>All 4 different authentication methods</li><li>Multiple different API features</li></ul><div class="expn-collapse"><button tabindex="0" class="btn btn-sm btn-filled btn-neutral" type="button"><span class="btn-label-wrap"><span class="btn-label-inner">Collapse&zwj;</span></span></button></div></div></div>
</div>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"></script>
  </body>


</html>